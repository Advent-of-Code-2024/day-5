const testInput:string = '47|53\n97|13\n97|61\n97|47\n75|29\n61|13\n75|53\n29|13\n97|29\n53|29\n61|53\n97|53\n61|29\n47|13\n75|47\n97|75\n47|61\n75|61\n47|29\n75|13\n53|13\n\n75,47,61,53,29\n97,61,53,29,13\n75,29,13\n75,97,47,61,53\n61,13,29\n97,13,75,29,47';
const input:string = '57|24\n64|37\n64|45\n19|47\n19|45\n19|95\n98|57\n98|37\n98|34\n98|87\n96|87\n96|74\n96|37\n96|97\n96|58\n11|44\n11|98\n11|94\n11|87\n11|91\n11|55\n62|57\n62|67\n62|76\n62|45\n62|92\n62|38\n62|19\n54|38\n54|11\n54|94\n54|97\n54|34\n54|84\n54|47\n54|45\n27|48\n27|65\n27|13\n27|95\n27|47\n27|89\n27|94\n27|55\n27|24\n13|42\n13|57\n13|98\n13|92\n13|81\n13|64\n13|34\n13|74\n13|62\n13|96\n99|84\n99|26\n99|45\n99|38\n99|27\n99|92\n99|35\n99|64\n99|97\n99|48\n99|37\n37|11\n37|68\n37|84\n37|12\n37|27\n37|63\n37|45\n37|48\n37|65\n37|38\n37|47\n37|69\n58|68\n58|95\n58|48\n58|35\n58|92\n58|37\n58|67\n58|57\n58|19\n58|84\n58|34\n58|45\n58|64\n89|42\n89|19\n89|54\n89|65\n89|75\n89|52\n89|73\n89|53\n89|12\n89|62\n89|22\n89|91\n89|55\n89|98\n73|54\n73|87\n73|99\n73|84\n73|37\n73|74\n73|19\n73|97\n73|81\n73|91\n73|57\n73|93\n73|63\n73|95\n73|62\n12|53\n12|22\n12|98\n12|44\n12|87\n12|14\n12|73\n12|54\n12|19\n12|52\n12|92\n12|81\n12|91\n12|69\n12|97\n12|65\n84|89\n84|68\n84|47\n84|24\n84|22\n84|78\n84|52\n84|55\n84|11\n84|76\n84|45\n84|38\n84|65\n84|69\n84|44\n84|14\n84|94\n95|47\n95|75\n95|76\n95|44\n95|69\n95|13\n95|11\n95|78\n95|35\n95|38\n95|89\n95|55\n95|14\n95|48\n95|68\n95|84\n95|65\n95|94\n22|81\n22|99\n22|73\n22|19\n22|96\n22|78\n22|57\n22|42\n22|91\n22|34\n22|87\n22|53\n22|63\n22|67\n22|64\n22|54\n22|74\n22|98\n22|44\n93|11\n93|22\n93|45\n93|65\n93|89\n93|52\n93|68\n93|12\n93|44\n93|78\n93|35\n93|98\n93|96\n93|38\n93|24\n93|76\n93|94\n93|69\n93|14\n93|13\n44|37\n44|73\n44|42\n44|64\n44|19\n44|54\n44|63\n44|91\n44|81\n44|87\n44|96\n44|58\n44|57\n44|62\n44|74\n44|67\n44|53\n44|34\n44|98\n44|92\n44|97\n81|34\n81|99\n81|87\n81|68\n81|95\n81|92\n81|42\n81|58\n81|62\n81|64\n81|57\n81|27\n81|97\n81|37\n81|91\n81|84\n81|26\n81|53\n81|74\n81|93\n81|67\n81|63\n87|63\n87|19\n87|53\n87|58\n87|34\n87|42\n87|74\n87|95\n87|57\n87|27\n87|62\n87|26\n87|68\n87|92\n87|91\n87|67\n87|84\n87|48\n87|97\n87|54\n87|99\n87|93\n87|37\n26|69\n26|55\n26|45\n26|65\n26|22\n26|76\n26|24\n26|38\n26|35\n26|52\n26|84\n26|47\n26|14\n26|13\n26|12\n26|95\n26|94\n26|89\n26|93\n26|44\n26|48\n26|11\n26|68\n26|75\n63|95\n63|89\n63|27\n63|45\n63|48\n63|93\n63|14\n63|35\n63|34\n63|55\n63|75\n63|38\n63|47\n63|65\n63|11\n63|69\n63|24\n63|12\n63|76\n63|68\n63|84\n63|67\n63|94\n63|26\n45|14\n45|96\n45|87\n45|13\n45|73\n45|89\n45|69\n45|47\n45|75\n45|81\n45|78\n45|38\n45|55\n45|52\n45|42\n45|94\n45|44\n45|91\n45|65\n45|24\n45|11\n45|12\n45|98\n45|22\n35|76\n35|78\n35|52\n35|87\n35|94\n35|65\n35|45\n35|47\n35|69\n35|12\n35|81\n35|89\n35|75\n35|14\n35|24\n35|13\n35|98\n35|73\n35|44\n35|11\n35|22\n35|96\n35|38\n35|55\n69|13\n69|64\n69|91\n69|19\n69|92\n69|14\n69|54\n69|57\n69|78\n69|53\n69|96\n69|52\n69|87\n69|42\n69|22\n69|73\n69|99\n69|98\n69|58\n69|62\n69|81\n69|97\n69|44\n69|65\n48|13\n48|76\n48|75\n48|65\n48|52\n48|96\n48|89\n48|44\n48|94\n48|69\n48|55\n48|73\n48|78\n48|22\n48|11\n48|47\n48|45\n48|35\n48|81\n48|12\n48|24\n48|14\n48|38\n48|98\n38|65\n38|75\n38|96\n38|44\n38|58\n38|13\n38|22\n38|52\n38|89\n38|87\n38|94\n38|78\n38|12\n38|24\n38|91\n38|55\n38|81\n38|42\n38|53\n38|98\n38|73\n38|11\n38|14\n38|69\n67|65\n67|68\n67|35\n67|14\n67|24\n67|26\n67|12\n67|84\n67|89\n67|11\n67|38\n67|27\n67|13\n67|55\n67|76\n67|47\n67|94\n67|93\n67|95\n67|69\n67|75\n67|45\n67|48\n67|52\n53|27\n53|19\n53|92\n53|48\n53|68\n53|47\n53|95\n53|67\n53|97\n53|64\n53|84\n53|76\n53|62\n53|34\n53|37\n53|35\n53|74\n53|45\n53|99\n53|54\n53|57\n53|63\n53|26\n53|93\n68|47\n68|69\n68|65\n68|94\n68|45\n68|73\n68|98\n68|89\n68|35\n68|52\n68|11\n68|14\n68|44\n68|55\n68|75\n68|78\n68|76\n68|12\n68|24\n68|38\n68|96\n68|48\n68|13\n68|22\n97|24\n97|45\n97|92\n97|74\n97|38\n97|34\n97|64\n97|76\n97|68\n97|47\n97|57\n97|94\n97|67\n97|93\n97|48\n97|89\n97|37\n97|27\n97|11\n97|26\n97|95\n97|84\n97|35\n97|63\n74|11\n74|63\n74|12\n74|84\n74|75\n74|55\n74|95\n74|69\n74|76\n74|93\n74|68\n74|24\n74|27\n74|38\n74|45\n74|26\n74|67\n74|37\n74|89\n74|34\n74|48\n74|47\n74|94\n74|35\n91|62\n91|37\n91|34\n91|64\n91|26\n91|74\n91|54\n91|63\n91|92\n91|42\n91|68\n91|84\n91|99\n91|57\n91|95\n91|27\n91|19\n91|58\n91|67\n91|48\n91|93\n91|53\n91|35\n91|97\n76|52\n76|12\n76|55\n76|98\n76|78\n76|87\n76|81\n76|22\n76|38\n76|75\n76|65\n76|73\n76|91\n76|47\n76|89\n76|13\n76|69\n76|11\n76|94\n76|44\n76|96\n76|45\n76|24\n76|14\n55|96\n55|98\n55|81\n55|99\n55|75\n55|13\n55|19\n55|54\n55|44\n55|12\n55|52\n55|87\n55|53\n55|58\n55|97\n55|69\n55|22\n55|91\n55|62\n55|73\n55|65\n55|78\n55|42\n55|14\n75|42\n75|14\n75|69\n75|78\n75|54\n75|64\n75|53\n75|81\n75|92\n75|62\n75|13\n75|73\n75|22\n75|91\n75|65\n75|98\n75|52\n75|44\n75|58\n75|19\n75|87\n75|97\n75|96\n75|99\n24|42\n24|14\n24|81\n24|58\n24|55\n24|62\n24|96\n24|44\n24|91\n24|75\n24|99\n24|53\n24|89\n24|54\n24|98\n24|65\n24|52\n24|12\n24|73\n24|69\n24|13\n24|22\n24|78\n24|87\n34|45\n34|76\n34|65\n34|47\n34|48\n34|93\n34|11\n34|68\n34|89\n34|84\n34|94\n34|27\n34|38\n34|67\n34|75\n34|95\n34|12\n34|35\n34|24\n34|69\n34|26\n34|52\n34|55\n34|14\n92|76\n92|74\n92|38\n92|45\n92|55\n92|89\n92|34\n92|64\n92|84\n92|93\n92|94\n92|57\n92|37\n92|48\n92|95\n92|26\n92|11\n92|27\n92|24\n92|63\n92|68\n92|67\n92|35\n92|47\n42|19\n42|34\n42|84\n42|63\n42|76\n42|64\n42|57\n42|74\n42|26\n42|62\n42|27\n42|54\n42|53\n42|95\n42|92\n42|48\n42|67\n42|93\n42|97\n42|35\n42|99\n42|68\n42|58\n42|37\n78|54\n78|63\n78|67\n78|58\n78|97\n78|98\n78|96\n78|53\n78|81\n78|27\n78|92\n78|99\n78|62\n78|57\n78|42\n78|73\n78|37\n78|34\n78|19\n78|74\n78|64\n78|87\n78|26\n78|91\n65|73\n65|58\n65|97\n65|87\n65|91\n65|54\n65|62\n65|13\n65|64\n65|78\n65|57\n65|99\n65|98\n65|19\n65|74\n65|42\n65|52\n65|96\n65|14\n65|44\n65|22\n65|81\n65|92\n65|53\n52|91\n52|19\n52|92\n52|53\n52|63\n52|64\n52|74\n52|99\n52|22\n52|13\n52|54\n52|57\n52|97\n52|73\n52|87\n52|98\n52|42\n52|58\n52|62\n52|81\n52|96\n52|44\n52|78\n52|37\n47|96\n47|89\n47|22\n47|69\n47|94\n47|73\n47|13\n47|91\n47|98\n47|24\n47|38\n47|42\n47|87\n47|58\n47|81\n47|75\n47|12\n47|11\n47|14\n47|55\n47|65\n47|52\n47|78\n47|44\n94|52\n94|44\n94|12\n94|99\n94|87\n94|98\n94|65\n94|14\n94|89\n94|96\n94|55\n94|81\n94|78\n94|53\n94|42\n94|75\n94|22\n94|24\n94|13\n94|58\n94|73\n94|69\n94|62\n94|91\n14|98\n14|22\n14|99\n14|19\n14|96\n14|91\n14|97\n14|58\n14|37\n14|62\n14|81\n14|44\n14|57\n14|78\n14|52\n14|87\n14|42\n14|64\n14|53\n14|13\n14|73\n14|92\n14|54\n14|74\n57|94\n57|47\n57|34\n57|93\n57|74\n57|89\n57|84\n57|11\n57|12\n57|37\n57|76\n57|27\n57|68\n57|95\n57|35\n57|67\n57|55\n57|38\n57|75\n57|63\n57|45\n57|48\n57|26\n64|27\n64|26\n64|34\n64|74\n64|35\n64|63\n64|38\n64|47\n64|93\n64|57\n64|12\n64|11\n64|94\n64|84\n64|48\n64|89\n64|24\n64|55\n64|95\n64|76\n64|68\n64|67\n19|93\n19|35\n19|97\n19|26\n19|76\n19|74\n19|68\n19|84\n19|27\n19|11\n19|67\n19|24\n19|37\n19|48\n19|63\n19|38\n19|64\n19|94\n19|92\n19|57\n19|34\n98|91\n98|19\n98|64\n98|27\n98|73\n98|58\n98|67\n98|42\n98|62\n98|53\n98|26\n98|97\n98|92\n98|95\n98|63\n98|99\n98|81\n98|84\n98|54\n98|74\n96|62\n96|34\n96|26\n96|19\n96|57\n96|98\n96|54\n96|64\n96|42\n96|99\n96|92\n96|63\n96|95\n96|73\n96|53\n96|91\n96|67\n96|81\n96|27\n11|14\n11|22\n11|65\n11|12\n11|53\n11|58\n11|96\n11|73\n11|52\n11|69\n11|81\n11|42\n11|24\n11|99\n11|13\n11|75\n11|89\n11|78\n62|95\n62|84\n62|48\n62|97\n62|68\n62|54\n62|93\n62|63\n62|37\n62|74\n62|34\n62|64\n62|11\n62|27\n62|26\n62|35\n62|47\n54|68\n54|63\n54|95\n54|76\n54|35\n54|48\n54|57\n54|19\n54|67\n54|64\n54|27\n54|93\n54|74\n54|92\n54|37\n54|26\n27|11\n27|14\n27|12\n27|35\n27|52\n27|68\n27|76\n27|26\n27|22\n27|84\n27|69\n27|45\n27|38\n27|75\n27|93\n13|54\n13|78\n13|99\n13|97\n13|73\n13|22\n13|19\n13|87\n13|44\n13|53\n13|91\n13|58\n13|63\n13|37\n99|93\n99|63\n99|19\n99|57\n99|74\n99|62\n99|34\n99|54\n99|67\n99|95\n99|68\n99|47\n99|76\n37|75\n37|95\n37|24\n37|89\n37|35\n37|55\n37|26\n37|76\n37|94\n37|34\n37|67\n37|93\n58|97\n58|74\n58|26\n58|53\n58|76\n58|62\n58|54\n58|27\n58|93\n58|63\n58|99\n89|87\n89|58\n89|78\n89|13\n89|69\n89|14\n89|99\n89|44\n89|96\n89|81\n73|42\n73|92\n73|26\n73|34\n73|27\n73|53\n73|58\n73|67\n73|64\n12|75\n12|78\n12|58\n12|96\n12|13\n12|99\n12|62\n12|42\n84|13\n84|48\n84|35\n84|75\n84|96\n84|12\n84|93\n95|22\n95|12\n95|24\n95|52\n95|45\n95|93\n22|37\n22|58\n22|92\n22|62\n22|97\n93|55\n93|75\n93|47\n93|48\n44|78\n44|27\n44|99\n81|54\n81|19\n87|64\n\n13,19,52,14,65,96,62,98,58,73,97,92,91,87,44,54,42\n26,11,93,84,95,45,63,89,27,65,55\n97,57,95,26,73,34,81,91,54,64,74\n74,91,42,62,87,27,53,98,81,92,97,99,54,63,57,67,96,26,34\n87,55,94,65,91,98,44,14,69,78,75,47,45,89,81\n26,95,84,93,68,48,35,76,47,38,11,94,24,89,55,12,75,69,65,14,52,13,22\n67,91,62,92,64,37,19,26,58,81,54,96,98\n95,38,94,89,69,13,44\n76,47,38,11,94,24,89,55,12,75,69,65,14,13,22,78,96,98,73,81,87\n19,97,92,64,57,74,37,63,67,27,26,95,84,93,68,48,45,38,11\n74,62,37,67,92,38,34,57,93\n65,42,58,73,97,92,53,54,87,57,22,98,78,81,52,96,14\n87,91,58,53,99,62,19,97,64,74,37,63,34,67,95,93,68\n98,11,24,14,89,52,22,55,75,47,42,44,78,38,91,96,81,65,87,94,69\n53,99,62,54,97,92,64,37,63,34,67,27,26,95,84,93,68,48,35,76,45\n94,24,89,55,75,69,14,52,44,73,81,91,58,53,99\n76,45,47,38,94,24,89,55,12,75,69,65,14,52,13,22,44,78,96,73,87\n63,37,68,89,24,38,11,84,27,94,92,95,93,34,64,45,35,67,57,74,26,76,47\n54,26,53,19,27,91,58,87,92,57,37,74,99,95,93,62,84,68,97\n89,55,12,69,65,14,52,13,22,78,96,98,73,87,91,42,58,53,99,62,54\n57,74,37,63,34,67,27,84,68,48,35,76,45,38,24,55,12\n97,64,57,67,45,47,24\n55,95,27,35,75,47,68,94,34,38,63,45,37,48,84,93,11,89,69,26,76,12,24\n63,27,26,95,93,68,35,76,45,47,38,11,94,89,65\n93,68,48,45,38\n75,69,13,22,96,73,87,62,92\n54,92,74,34,27,84,68,35,11\n91,42,58,62,54,97,92,57,74,63,34,95,84,93,48\n53,19,87,13,64,74,96,14,73,58,92\n63,67,84,35,76,47,89,55,65\n55,38,47,68,24,75,12,94,37,74,34\n35,62,37,54,58,68,99,42,19\n97,57,37,67,27,84,68,35,76,38,24\n24,89,75,69,65,14,52,13,22,98,87,91,42,58,62\n63,73,42,19,37,62,64,58,92,78,81,74,57,44,22,91,13,54,87,97,98,53,96\n48,68,37,58,76,34,19,57,35,63,74,84,97,53,99,27,54\n57,37,34,67,84,93,48,24,89,55,12\n99,42,27,98,19,54,73\n98,81,99,67,95,63,57,92,64,62,27,19,74,53,97\n96,37,54,99,62,53,52,92,74,64,97\n54,68,38,19,76,95,45,48,74\n69,52,13,58,53,54,92\n13,22,78,96,98,73,81,87,42,58,53,99,62,54,19,97,92,64,57,37,63\n27,95,48,55,69\n38,94,24,69,44,96,73\n74,68,37,26,35,48,62,58,27,93,34,95,92,53,97\n47,68,24,52,65,14,98,69,94,44,75,38,22,96,45,11,13\n12,47,48,38,24,34,84,37,26,93,94,11,63,74,89,68,45,35,75\n12,75,52,44,78,98,87,42,53,62,54,19,97\n47,89,12,96,98,81,42\n67,27,26,95,84,93,68,48,35,76,45,47,38,11,94,24,89,55,12,75,69,65,52\n74,99,81,64,98,13,52,87,19,42,22,54,58,97,92,37,91,62,44\n73,81,87,91,42,58,53,99,62,54,19,97,92,64,57,74,63,34,67,27,26,95,84\n99,53,91,13,12,22,65\n73,81,87,91,58,53,99,62,54,19,97,92,64,57,74,37,63,34,67,27,26,95,84\n92,64,57,74,37,63,34,67,27,26,95,84,93,68,48,35,76,45,47,38,94,24,89\n87,91,42,53,62,19,97,64,37,26,84\n26,74,68,47,93,12,76,11,94,95,57,37,55,89,27,63,24,48,35\n69,65,14,52,13,22,44,96,98,73,81,87,91,42,58,53,99,62,54,19,97,92,64\n63,92,74,64,68,62,93,57,27,97,84,42,35,48,95,26,34,19,53,99,37,67,58\n62,27,84,68,74,99,93,47,76,64,26\n12,91,65,75,87,19,62\n89,75,69,65,14,99,54\n94,76,37,67,38,11,55,95,93,34,45,89,63,35,64,68,47\n45,93,47,94,95,65,69,75,11,89,14,84,13,35,12\n24,89,55,69,65,14,78,98,81,91,62\n74,35,93,57,99,19,54,97,37,95,58\n45,93,26,27,48,54,95,84,67,35,19,34,97,62,37,68,47,99,76,57,63\n74,63,34,26,95,84,93,48,35,45,47,94,12\n96,42,73,22,65,53,52,57,78\n35,57,38,63,12,76,67,94,37,89,95\n35,76,45,47,38,11,94,24,75,69,65,14,52,13,44,78,96,73,81\n35,76,45,47,38,11,24,55,12,75,65,14,52,22,44,96,98,73,81\n13,52,54,96,78\n81,87,42,58,53,99,62,19,97,92,64,57,74,37,63,34,67,27,95,84,93\n74,64,84,42,37,57,99,62,58,92,27,67,97,95,53,68,91,63,26,54,48,93,34\n84,26,37,63,76,45,94,35,95,69,11\n37,26,93,64,97,67,38,95,68,94,11,76,27,92,24,63,84,48,47\n97,99,62,87,13,44,42,19,22,78,52,37,96,64,92,73,98\n67,27,95,84,68,48,35,76,11,94,12,75,69,65,52\n38,55,65,48,94,68,45,69,14,35,84,89,13,95,76,12,47,24,93,22,26\n44,96,81,87,91,42,53,99,62,19,97,92,37\n81,87,42,58,53,99,62,54,19,97,92,64,57,74,37,63,34,67,27,26,95,84,93\n13,98,81,87,58,99,54,19,97,57,63\n34,67,27,68,35,76,47,38,94,24,55,12,69,65,14\n53,65,91,69,96,22,73,87,75\n55,75,69,65,14,22,44,78,96,81,91,42,58,53,19\n92,62,54,95,57,27,74\n96,98,75,94,13,87,78,73,99,12,65\n11,94,24,89,69,14,52,13,22,44,78,96,73,81,87,91,42,58,53\n84,34,81,97,58,63,87,54,53,74,57,92,93,91,62,19,42,26,95\n57,35,27,74,37,64,47,94,97,68,48\n64,37,63,34,26,48,35,24,55\n67,76,27,55,34,89,11,14,68,47,35,26,95,65,75,12,69,94,93\n38,48,94,27,68,67,95,89,12,52,84,24,26,11,75,76,69,35,14\n38,65,75,14,35,55,76,68,52,98,44\n27,26,68,11,89,12,65\n74,27,99,54,26,19,95,37,92,64,42,98,67\n87,91,58,53,99,62,19,97,92,64,37,67,27,95,84,93,68\n63,55,74,94,84,11,57,27,38,48,12\n65,64,19,69,96,52,81,14,53,44,87,73,42,13,54\n76,38,89,22,11,24,47,84,13,69,75,45,78,44,94,52,14,93,65,55,48\n24,96,47,87,44,52,78,98,81,75,42,13,89,12,65,14,94,69,91\n35,89,45,78,94,24,38,22,14,96,98,55,44,75,65,11,52,12,68,48,69\n42,14,81,98,65,91,53,75,52,96,12,78,69,44,54,99,89\n12,75,69,14,52,13,44,96,73,87,91,42,58,53,99,62,54,19,97\n44,96,73,81,87,91,42,58,53,99,62,54,19,92,57,74,63,34,67\n27,35,45,47,11,94,89,12,13\n19,97,92,64,57,74,37,63,67,27,26,95,84,93,68,48,35,76,45,47,38,11,94\n91,53,11,96,94,42,12,78,69,22,73,87,55\n14,52,22,78,98,73,42,99,62,19,97,64,74\n55,22,44,81,87,58,19\n38,11,94,24,89,55,12,75,69,65,14,52,13,22,44,78,96,98,73,81,91,42,58\n24,12,14,53,62,91,55,75,99\n98,74,34,92,62,53,42,26,19,58,64,73,37,87,97,27,81,96,63,99,57,67,54\n89,11,13,98,12,47,55,45,44,65,52,38,94,14,22,87,81,78,69,91,73\n34,67,26,84,93,68,48,35,76,45,47,11,24,89,12,75,69,65,14\n75,69,65,14,52,13,22,78,98,87,91,42,58,53,62,54,19,97,92\n42,99,78,73,98,54,52,13,96,55,69,14,89,22,44,62,81,65,58\n76,45,47,38,11,94,89,55,75,69,14,52,13,22,44,78,98,73,81\n74,37,95,84,45\n98,47,45,78,68,13,76,22,11\n65,99,44,73,53,55,91,52,98\n26,84,68,48,35,76,11,89,69,13,22\n38,67,47,63,34,76,92,74,37,24,48,95,94,84,57,89,64,93,45,68,35,27,11\n53,63,87,73,44,91,13,92,62\n47,38,11,94,24,89,55,12,75,69,65,14,52,13,22,44,78,98,73,81,87,91,42\n69,52,44,78,96,98,87,91,42,58,62,54,19,92,64\n22,47,98,12,65,52,89,11,78,94,75,45,96,38,69,68,35,48,76,13,14\n38,11,94,24,89,55,75,13,44,78,98,73,91,42,58\n81,67,78,96,92,58,97,62,99,98,87,64,44,34,73,63,53\n99,62,54,19,92,64,57,74,63,34,67,26,95,68,48,76,45\n57,74,67,27,84,68,48\n11,24,55,12,13,22,96,73,91,42,53\n91,14,78,62,42,74,58,52,22,81,97,92,53,44,98,99,54,64,73,19,96\n42,58,99,92,57,74,37,95,84,68,35\n57,76,48,27,94,38,47,93,67,37,63,64,74,11,84,45,19,92,95\n63,44,19,34,99,67,37,87,92\n19,35,92,68,34,47,93,26,57,95,74,37,54,48,45,27,84,11,67,97,38,64,76\n84,93,68,48,35,45,47,38,11,94,24,89,55,12,75,69,65,14,52,13,22,44,78\n12,94,84,48,45,24,76,68,52,13,14\n95,45,93,27,35,34,37,24,63,38,26,94,68,48,76,89,75,11,69,84,47,67,55\n84,93,68,94,24,89,55,12,75,69,65,14,52,44,78\n73,58,57,99,92,53,19,91,37,81,34,63,87,67,54,78,64,27,96,42,62\n57,63,42,54,96,44,87,78,19,67,99,74,62\n34,19,84,67,74,93,94,48,27\n11,94,24,89,55,12,75,69,65,14,52,13,44,78,96,98,73,81,87,91,42,58,53\n48,76,75,93,44,38,89,35,94,24,45,13,14,78,47,68,69,96,65,12,11\n34,67,27,26,84,93,68,48,35,76,45,47,38,11,94,24,55,75,69,65,14\n11,24,89,55,12,75,69,65,52,13,22,44,78,98,73,81,87,91,42,58,53\n92,64,37,27,26,95,93,35,45,47,38,11,89\n44,89,13,65,11,94,76,69,48,14,35,22,73,75,55,38,45,78,96,98,52\n92,64,26,48,47\n52,69,38,55,27,11,12,95,94,84,13,76,45\n45,47,38,11,94,24,89,55,12,75,69,65,52,13,22,44,78,96,98,73,81,87,91\n52,44,91,99,19,97,37\n65,47,89,38,55,75,96,91,12,45,98,13,44,69,52,94,87,81,24,14,78\n93,68,48,35,38,11,94,24,89,12,69,65,14,52,22,44,96\n24,47,95,12,68,76,14,67,75,48,89,84,69\n24,89,55,12,75,69,65,14,52,13,22,78,96,81,87,42,58,53,62\n67,35,92,93,76,99,54,58,48\n38,11,94,89,55,65,13,22,44,78,96,98,81,87,91,42,58\n91,99,54,19,97,92,37,63,34,67,26,95,84,68,48\n48,45,47,94,14,13,73\n24,22,98,38,76,47,75,12,81,55,35,94,78\n73,81,42,65,53,58,94,75,96,52,98,69,24,12,89,55,44,13,11,91,87,78,14\n95,84,93,68,48,35,76,45,47,38,94,24,89,75,69,65,14,52,13,22,44\n37,19,99,64,26,92,74,57,63,81,42,62,53,54,98,67,73,34,96,97,87,27,91\n42,14,98,96,53,75,99,44,19,65,13,62,54,73,12,69,58,97,78,87,91,81,22\n34,99,27,26,19,92,97,42,63,87,96,81,37,58,73,67,54\n99,54,57,34,27,26,95,93,68\n98,75,76,47,13,48,14,38,44,68,94,12,96,69,52,78,35\n38,97,24,11,74,76,47,84,95,63,67,35,94\n34,27,95,75,69\n22,44,78,96,42,58,53,57,74,37,34\n55,81,13,47,98,11,12,96,65,89,73,22,69,35,76,75,52\n19,97,92,64,57,74,63,26,95,93,68,48,35,45,38,11,94\n34,73,42,78,57,53,63,92,27\n73,98,99,78,58,54,37,53,91,19,44,87,63,62,42,22,64,13,57\n27,94,12,76,69,45,55,68,67,14,38,26,89,75,84,93,35\n91,42,58,99,54,64,57,74,63,67,26,95,84,93,48\n81,73,96,87,53,99,42\n54,81,98,22,87,65,91,53,96,52,55,69,19,99,44,73,12,62,78,75,13\n42,58,53,99,62,54,19,97,92,64,57,74,34,67,27,26,95,84,93,68,48\n26,68,54,97,48,57,67,91,53,42,37,93,58,63,34,19,84\n92,67,84,93,37,53,27,57,95,64,63,91,19,81,62,99,74,97,26\n53,99,62,54,19,92,64,37,34,67,26,95,84,93,68,48,35,76,45\n81,42,19,92,37,67,27,26,93\n11,89,47,24,91,87,12,22,52,81,98,45,65\n14,65,24,12,38,75,96\n68,58,91,53,99,26,92,27,87,67,37\n52,48,95,47,44,84,11,93,69\n76,45,47,38,11,24,89,55,12,75,65,14,52,13,22,44,78,96,98,81,87\n35,26,47,67,74,93,94,45,34,27,95\n73,34,44,98,64,22,19\n53,74,63,34,95,48,45\n91,42,58,53,99,62,54,19,97,92,64,74,63,67,27,26,95,93,48\n92,38,93,37,11,63,45,27,74,95,34,64,89\n67,35,84,34,62,74,57,48,27,63,97\n44,42,58,53,99,54,64,57,67\n91,19,37,87,22,92,74,57,96,81,34,62,98\n24,35,84,93,69,89,65,47,63\n84,93,68,48,35,76,45,47,11,94,24,89,55,12,75,69,65,13,22,44,78\n38,11,94,24,89,55,12,75,69,65,14,13,22,78,96,98,73,81,91,42,58\n75,65,98,73,87,91,54\n38,93,97,92,95,19,34,37,57,68,76,74,27,45,54,67,62,48,64,84,35\n89,55,12,75,69,65,14,22,44,78,98,73,81,87,91,42,58,53,99,62,54\n26,95,84,93,68,48,35,76,45,38,11,94,24,89,55,12,75,69,65,14,13\n53,54,52,97,22,99,65,14,69,12,19,91,58,98,42,44,87,62,96,78,13\n48,93,94,67,89,47,38,64,57,35,24,74,26,63,55,68,11,37,76\n64,57,74,63,34,67,26,48,76,45,47,38,94,89,55\n73,89,13,44,14,47,76,75,65,45,12,52,24,69,78,35,11,94,81,96,98\n84,93,48,76,45,47,38,11,94,24,89,55,12,69,65,14,13,22,44\n97,54,87,19,91,75,69,99,52,96,12,13,73,62,65\n24,69,87,78,55,13,58,22,11,96,12,65,52,89,38\n62,19,74,27,95,84,38\n58,99,62,54,97,92,64,57,74,63,34,67,27,95,84,93,68,48,76\n14,13,22,87,42,58,53,62,54,97,92,57,74\n48,97,26,38,84,34,27,63,94,95,57,93,76,35,64,37,19,45,68\n27,69,75,76,12,95,47,68,67,45,89,55,38,35,93,94,84,14,34,24,48\n87,52,55,14,13,47,94,24,69,65,11,78,91,45,38,89,81,98,73,75,22,12,44\n52,13,73,87,91,54,19,97,37\n34,67,27,95,84,93,48,45,38,11,94,12,75,65,14';

// Table cells for displaying data
const pt1MiddleSumTD:HTMLTableCellElement = <HTMLTableCellElement>document.getElementById('pt1OrderedMiddleSum');
const pt2MiddleSumTD:HTMLTableCellElement = <HTMLTableCellElement>document.getElementById('pt2OrderedMiddleSum');

/**************/
/*   Part 1   */
/**************/
const [ rules, updates ] = input.split('\n\n');

const rulesArray:string[] = rules.split('\n');
const updatesArray:string[] = updates.split('\n');

/**
 * @param {string[]} rules - Strings in the format: num1|num2 where num1 must precede num2
 * @param {string[]} updates - Strings in the format #,#,#,#,#... that are checked agains rules
 * 
 * @return {string[]} Updates that do not violate the rules
 */
function findOrderedUpdates(rules:string[],updates:string[]):string[] {
  let orderedUpdates:string[] = [];
  let rulesTest:string = rules.map(rule => '('.concat(rule.split('|').reverse().join('.*'),')')).join('|')
  
  let violationRegEx:RegExp = new RegExp(rulesTest);

  for ( let pages of updates ) {
    let isUnordered:boolean = violationRegEx.test(pages);

    !isUnordered && orderedUpdates.push(pages);
  }

  return orderedUpdates;
}
/**
 * @param {string[]} pages - Array of stringified numbers
 * 
 * @throws {RangeError} pages must be odd length to retrieve middle number
 * @return {number} Summation of the middle elements
 */
function findMiddleSum(updates:string[]):number {
  let middleSum:number = updates.reduce((sum:number,pages:string) => {
    let pageNums:string[] = pages.split(',');

    if ( pageNums.length % 2 === 0 )
      throw new RangeError('Page numbers must contain an odd number of pages');

    let middlePageIndex:number = Math.floor(pageNums.length / 2);
    let middlePageNumStr:string = pageNums[middlePageIndex];
    let middlePageNum:number = parseInt(middlePageNumStr);

    sum += middlePageNum;

    return sum;
  },0)

  return middleSum;
}

let orderedUpdates:string[] = findOrderedUpdates(rulesArray,updatesArray);
let middleSum:number = findMiddleSum(orderedUpdates);

pt1MiddleSumTD.textContent = middleSum.toString();

/**************/
/*   Part 2   */
/**************/
/**
 * @param {string[]} rules - Strings in the format: num1|num2 where num1 must precede num2
 * @param {string[]} updates - Strings in the format #,#,#,#,#... that are checked agains rules
 * 
 * @return {string[]} Updates that violate the rules
 */
function findUnorderedUpdates(rules:string[],updates:string[]):string[] {
  let unorderedUpdates:string[] = [];
  let rulesTest:string = rules.map(rule => '('.concat(rule.split('|').reverse().join('.*'),')')).join('|')
  
  let violationRegEx:RegExp = new RegExp(rulesTest);

  for ( let pages of updates ) {
    let isUnordered:boolean = violationRegEx.test(pages);

    isUnordered && unorderedUpdates.push(pages);
  }

  return unorderedUpdates;
}
function orderUpdate(rules:string[],update:string):string {
  for ( let rule of rules ) {
    let [num1, num2] = rule.split('|');
    let pageNums:string[] = update.split(',');
    let indexNum1:number = pageNums.indexOf(num1);
    let indexNum2:number = pageNums.indexOf(num2);

    if ( indexNum1 > -1 && indexNum2 > -1 ) {
      if ( indexNum1 > indexNum2 ) {
        pageNums[indexNum1] = num2;
        pageNums[indexNum2] = num1;

        update = orderUpdate(rules,pageNums.join(','));
      }
    }
  }

  return update;
}
function orderUpdates(rules:string[],unorderedUpdates:string[]):string[] {
  let orderedUpdates:string[] = [];

  for ( let unorderedUpdate of unorderedUpdates ) {
    let updatedOrder:string = orderUpdate(rules,unorderedUpdate);
    orderedUpdates.push(updatedOrder);
  }

  return orderedUpdates;
}
let unorderedUpdates:string[] = findUnorderedUpdates(rulesArray,updatesArray);
let newOrderedUpdates:string[] = orderUpdates(rulesArray,unorderedUpdates);
let middleSum2:number = findMiddleSum(newOrderedUpdates); 

pt2MiddleSumTD.textContent = middleSum2.toString();
